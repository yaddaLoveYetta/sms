

define(function (require) {



    var id$module = {};

    function define(id, exports) {

        id$module[id] = {
            required: false,
            exports: exports
        };
    }

    function innerRequire(id) {

        var module = id$module[id];
        if (!module) {
            return;
        }

        var exports = module.exports;

        if (module.required) {
            return exports;
        }

        if (typeof exports == 'function') {

            var fn = exports;
            exports = {};
            var mod = {
                exports: exports
            };

            var value = fn(innerRequire, exports, mod);

            //û��ͨ�� return ������ֵ����Ҫ���µ�ֵ�� mod.exports ��
            exports = value === undefined ? mod.exports : value;
            module.exports = exports;
        }

        module.required = true; //ָʾ�Ѿ� innerRequire ��һ��

        return exports;

    };

    $.extend(innerRequire, require);




    //------------------------------------

    define('jquery', function () {
        return jQuery;
    });


    /*!
    * artDialog - Ĭ������
    */
    define("dialog-config", {

        /* -----��ע�͵����ü̳��� popup.js���Կ������������¶�����----- */

        // ���뷽ʽ
        //align: 'bottom left',

        // �Ƿ�̶���λ
        //fixed: false,

        // �Ի�����Ӹ߶�ֵ(��Ҫ����ֵ���ܳ���������������)
        //zIndex: 1024,

        // �������ֱ�����ɫ
        //backdropBackground: '#000',

        // ��������͸����
        //backdropOpacity: 0.7,

        backdropOpacity: 0.4,

        // ��Ϣ����
        content: '<span class="ui-dialog-loading">Loading..</span>',

        // ����
        title: '',

        // �Ի���״̬������ HTML ����
        statusbar: '',

        // �Զ��尴ť
        button: null,

        // ȷ����ť�ص�����
        ok: null,

        // ȡ����ť�ص�����
        cancel: null,

        // ȷ����ť�ı�
        okValue: 'ok',

        // ȡ����ť�ı�
        cancelValue: 'cancel',

        cancelDisplay: true,

        // ���ݿ��
        width: '',

        // ���ݸ߶�
        height: '',

        // ������߽�������
        padding: '',

        // �Ի����Զ��� className
        skin: '',

        // �Ƿ�֧�ֿ�ݹرգ�������ֲ��Զ��رգ�
        quickClose: false,

        // css �ļ�·���������򲻻�ʹ�� js �Զ�������ʽ
        // ע�⣺css ֻ�������һ��
        //cssUri: '../css/ui-dialog.css',
        cssUri: './dialog.all.' + SMS.Debug.get() + '.css#',

        // ģ�壨ʹ�� table ��� IE7 �������Ӧ�� BUG��
        // js ʹ�� i="***" ����ʶ��ṹ������ľ����Զ���
        innerHTML:
            '<div i="dialog" class="ui-dialog">'
            + '<div class="ui-dialog-arrow-a"></div>'
            + '<div class="ui-dialog-arrow-b"></div>'
            + '<table class="ui-dialog-grid">'
            + '<tr>'
            + '<td i="header" class="ui-dialog-header">'
            + '<button i="close" class="ui-dialog-close">&#215;</button>'
            + '<div i="title" class="ui-dialog-title"></div>'
            + '</td>'
            + '</tr>'
            + '<tr>'
            + '<td i="body" class="ui-dialog-body">'
            + '<div i="content" class="ui-dialog-content"></div>'
            + '</td>'
            + '</tr>'
            + '<tr>'
            + '<td i="footer" class="ui-dialog-footer">'
            + '<div i="statusbar" class="ui-dialog-statusbar"></div>'
            + '<div i="button" class="ui-dialog-button"></div>'
            + '</td>'
            + '</tr>'
            + '</table>'
            + '</div>'

    });



    /*!
    * popupjs
    * Date: 2014-01-15
    * https://github.com/aui/popupjs
    * (c) 2009-2013 TangBin, http://www.planeArt.cn
    *
    * This is licensed under the GNU LGPL, version 2.1 or later.
    * For details, see: http://www.gnu.org/licenses/lgpl-2.1.html
    */
    define("popup", function (innerRequire) {

        var $ = innerRequire("jquery");

        var _count = 0;
        var _isIE6 = !('minWidth' in $('html')[0].style);
        var _isFixed = !_isIE6;


        function Popup() {

            this.destroyed = false;


            this.__popup = $('<div />')
            .attr({
                tabindex: '-1'
            })
            .css({
                display: 'none',
                position: 'absolute',
                left: 0,
                top: 0,
                bottom: 'auto',
                right: 'auto',
                margin: 0,
                padding: 0,
                outline: 0,
                border: '0 none',
                background: 'transparent'
            })
            .html(this.innerHTML)
            .appendTo('body');


            this.__backdrop = $('<div />');


            // ʹ�� HTMLElement ��Ϊ�ⲿ�ӿ�ʹ�ã������� jquery ����
            // ͳһ�Ľӿ�����δ�� Popup ��ֲ������ DOM ����
            this.node = this.__popup[0];
            this.backdrop = this.__backdrop[0];

            _count++;
        }


        $.extend(Popup.prototype, {

            /**
                * ��ʼ������¼����� show()��showModal() ִ��
                * @name Popup.prototype.onshow
                * @event
                */

            /**
                * �ر��¼����� close() ִ��
                * @name Popup.prototype.onclose
                * @event
                */

            /**
                * ����ǰ�¼����� remove() ǰִ��
                * @name Popup.prototype.onbeforeremove
                * @event
                */

            /**
                * �����¼����� remove() ִ��
                * @name Popup.prototype.onremove
                * @event
                */

            /**
                * �����¼����� reset() ִ��
                * @name Popup.prototype.onreset
                * @event
                */

            /**
                * �����¼����� foucs() ִ��
                * @name Popup.prototype.onfocus
                * @event
                */

            /**
                * ʧ���¼����� blur() ִ��
                * @name Popup.prototype.onblur
                * @event
                */

            /** ���� DOM �ؽڵ� */
            node: null,

            /** ���� DOM �ڵ� */
            backdrop: null,

            /** �Ƿ����̶���λ */
            fixed: false,

            /** �ж϶Ի����Ƿ�ɾ�� */
            destroyed: true,

            /** �ж϶Ի����Ƿ���ʾ */
            open: false,

            /** close ����ֵ */
            returnValue: '',

            /** �Ƿ��Զ��۽� */
            autofocus: true,

            /** ���뷽ʽ */
            align: 'bottom left',

            /** �������ֱ�����ɫ */
            backdropBackground: '#000',

            /** ��������͸���� */
            backdropOpacity: 0.7,

            /** �ڲ��� HTML �ַ��� */
            innerHTML: '',

            /** ���� */
            className: 'ui-popup',

            /**
                * ��ʾ����
                * @param   {HTMLElement, Event}  ָ��λ�ã���ѡ��
                */
            show: function (anchor) {

                if (this.destroyed) {
                    return this;
                }

                var that = this;
                var popup = this.__popup;

                this.__activeElement = this.__getActive();

                this.open = true;
                this.follow = anchor || this.follow;


                if (!this.__ready) {

                    popup.addClass(this.className);

                    if (this.modal) {
                        this.__lock();
                    }


                    if (!popup.html()) {
                        popup.html(this.innerHTML);
                    }


                    if (!_isIE6) {
                        $(window).on('resize', this.__onresize = function () {
                            that.reset();
                        });
                    }


                    this.__ready = true;
                }


                popup
                .addClass(this.className + '-show')
                .attr('role', this.modal ? 'alertdialog' : 'dialog')
                .css('position', this.fixed ? 'fixed' : 'absolute')
                .show();

                this.__backdrop.show();




                this.reset().focus();
                this.__dispatchEvent('show');

                return this;
            },


            /** ��ʾģ̬���㡣�����μ� show() */
            showModal: function () {
                this.modal = true;
                return this.show.apply(this, arguments);
            },


            /** �رո��� */
            close: function (result) {

                if (!this.destroyed && this.open) {

                    if (result !== undefined) {
                        this.returnValue = result;
                    }

                    this.__popup.hide().removeClass(this.className + '-show');
                    this.__backdrop.hide();
                    this.open = false;
                    this.blur();
                    this.__dispatchEvent('close');
                }

                return this;
            },


            /** ���ٸ��� */
            remove: function () {

                if (this.destroyed) {
                    return this;
                }

                this.__dispatchEvent('beforeremove');

                if (Popup.current === this) {
                    Popup.current = null;
                }

                this.__unlock();
                this.__popup.remove();
                this.__backdrop.remove();


                // �ָ����㣬�չ˼��̲������û�
                this.blur();

                if (!_isIE6) {
                    $(window).off('resize', this.__onresize);
                }

                this.__dispatchEvent('remove');

                for (var i in this) {
                    delete this[i];
                }

                return this;
            },


            /** �ֶ�ˢ��λ�� */
            reset: function () {

                var elem = this.follow;

                if (elem) {
                    this.__follow(elem);
                } else {
                    this.__center();
                }

                this.__dispatchEvent('reset');

                return this;
            },


            /** �ø����ȡ���� */
            focus: function () {

                var node = this.node;
                var current = Popup.current;

                if (current && current !== this) {
                    current.blur(false);
                }

                // ��齹���Ƿ��ڸ�������
                if (!$.contains(node, this.__getActive())) {
                    var autofocus = this.__popup.find('[autofocus]')[0];

                    if (!this._autofocus && autofocus) {
                        this._autofocus = true;
                    } else {
                        autofocus = node;
                    }

                    this.__focus(autofocus);
                }

                Popup.current = this;
                this.__popup.addClass(this.className + '-focus');
                this.__zIndex();
                this.__dispatchEvent('focus');

                return this;
            },


            /** �ø���ʧȥ���㡣�������˻���֮ǰ��Ԫ�أ��չ������ϰ��û� */
            blur: function () {

                var activeElement = this.__activeElement;
                var isBlur = arguments[0];


                if (isBlur !== false) {
                    this.__focus(activeElement);
                }

                this._autofocus = false;
                this.__popup.removeClass(this.className + '-focus');
                this.__dispatchEvent('blur');

                return this;
            },


            /**
                * ����¼�
                * @param   {String}    �¼�����
                * @param   {Function}  ��������
                */
            addEventListener: function (type, callback) {
                this.__getEventListener(type).push(callback);
                return this;
            },


            /**
                * ɾ���¼�
                * @param   {String}    �¼�����
                * @param   {Function}  ��������
                */
            removeEventListener: function (type, callback) {
                var listeners = this.__getEventListener(type);
                for (var i = 0; i < listeners.length; i++) {
                    if (callback === listeners[i]) {
                        listeners.splice(i--, 1);
                    }
                }
                return this;
            },


            // ��ȡ�¼�����
            __getEventListener: function (type) {
                var listener = this.__listener;
                if (!listener) {
                    listener = this.__listener = {};
                }
                if (!listener[type]) {
                    listener[type] = [];
                }
                return listener[type];
            },


            // �ɷ��¼�
            __dispatchEvent: function (type) {
                var listeners = this.__getEventListener(type);

                if (this['on' + type]) {
                    this['on' + type]();
                }

                for (var i = 0; i < listeners.length; i++) {
                    listeners[i].call(this);
                }
            },


            // ��Ԫ�ذ�ȫ�۽�
            __focus: function (elem) {
                // ��ֹ iframe ������Ȩ�ޱ���
                // ��ֹ IE ���ɼ�Ԫ�ر���
                try {
                    // ie11 bug: iframe ҳ��������������
                    if (this.autofocus && !/^iframe$/i.test(elem.nodeName)) {
                        elem.focus();
                    }
                } catch (e) { }
            },


            // ��ȡ��ǰ�����Ԫ��
            __getActive: function () {
                try {// try: ie8~9, iframe #26
                    var activeElement = document.activeElement;
                    var contentDocument = activeElement.contentDocument;
                    var elem = contentDocument && contentDocument.activeElement || activeElement;
                    return elem;
                } catch (e) { }
            },


            // �ö�����
            __zIndex: function () {

                var index = Popup.zIndex++;

                // ���õ��Ӹ߶�
                this.__popup.css('zIndex', index);
                this.__backdrop.css('zIndex', index - 1);
                this.zIndex = index;
            },


            // ���и���
            __center: function () {

                var popup = this.__popup;
                var $window = $(window);
                var $document = $(document);
                var fixed = this.fixed;
                var dl = fixed ? 0 : $document.scrollLeft();
                var dt = fixed ? 0 : $document.scrollTop();
                var ww = $window.width();
                var wh = $window.height();
                var ow = popup.width();
                var oh = popup.height();
                var left = (ww - ow) / 2 + dl;
                var top = (wh - oh) * 382 / 1000 + dt;// �ƽ����
                var style = popup[0].style;


                style.left = Math.max(parseInt(left), dl) + 'px';
                style.top = Math.max(parseInt(top), dt) + 'px';
            },


            // ָ��λ�� @param    {HTMLElement, Event}  anchor
            __follow: function (anchor) {

                var $elem = anchor.parentNode && $(anchor);
                var popup = this.__popup;


                if (this.__followSkin) {
                    popup.removeClass(this.__followSkin);
                }


                // ����Ԫ�ز�����
                if ($elem) {
                    var o = $elem.offset();
                    if (o.left * o.top < 0) {
                        return this.__center();
                    }
                }

                var that = this;
                var fixed = this.fixed;

                var $window = $(window);
                var $document = $(document);
                var winWidth = $window.width();
                var winHeight = $window.height();
                var docLeft = $document.scrollLeft();
                var docTop = $document.scrollTop();


                var popupWidth = popup.width();
                var popupHeight = popup.height();
                var width = $elem ? $elem.outerWidth() : 0;
                var height = $elem ? $elem.outerHeight() : 0;
                var offset = this.__offset(anchor);
                var x = offset.left;
                var y = offset.top;
                var left = fixed ? x - docLeft : x;
                var top = fixed ? y - docTop : y;


                var minLeft = fixed ? 0 : docLeft;
                var minTop = fixed ? 0 : docTop;
                var maxLeft = minLeft + winWidth - popupWidth;
                var maxTop = minTop + winHeight - popupHeight;


                var css = {};
                var align = this.align.split(' ');
                var className = this.className + '-';
                var reverse = { top: 'bottom', bottom: 'top', left: 'right', right: 'left' };
                var name = { top: 'top', bottom: 'top', left: 'left', right: 'left' };


                var temp = [{
                    top: top - popupHeight,
                    bottom: top + height,
                    left: left - popupWidth,
                    right: left + width
                }, {
                    top: top,
                    bottom: top - popupHeight + height,
                    left: left,
                    right: left - popupWidth + width
                }];


                var center = {
                    left: left + width / 2 - popupWidth / 2,
                    top: top + height / 2 - popupHeight / 2
                };


                var range = {
                    left: [minLeft, maxLeft],
                    top: [minTop, maxTop]
                };


                // ������������������Ӧλ��
                $.each(align, function (i, val) {

                    // �����һ��±߽磺ʹ��������ϱ߶���
                    if (temp[i][val] > range[name[val]][1]) {
                        val = align[i] = reverse[val];
                    }

                    // ��������ұ߽磺ʹ���һ����±߶���
                    if (temp[i][val] < range[name[val]][0]) {
                        align[i] = reverse[val];
                    }

                });


                // һ�����������
                if (!align[1]) {
                    name[align[1]] = name[align[0]] === 'left' ? 'top' : 'left';
                    temp[1][align[1]] = center[name[align[1]]];
                }

                className += align.join('-');

                that.__followSkin = className;


                if ($elem) {
                    popup.addClass(className);
                }


                css[name[align[0]]] = parseInt(temp[0][align[0]]);
                css[name[align[1]]] = parseInt(temp[1][align[1]]);
                popup.css(css);

            },


            // ��ȡԪ�������ҳ���λ�ã�����iframe�ڵ�Ԫ�أ�
            // ��ʱ��֧���������ϵ� iframe ��Ƕ
            __offset: function (anchor) {

                var isNode = anchor.parentNode;
                var offset = isNode ? $(anchor).offset() : {
                    left: anchor.pageX,
                    top: anchor.pageY
                };


                anchor = isNode ? anchor : anchor.target;
                var ownerDocument = anchor.ownerDocument;
                var defaultView = ownerDocument.defaultView || ownerDocument.parentWindow;

                if (defaultView == window) {// IE <= 8 ֻ��ʹ���������ں�
                    return offset;
                }

                // {Element Ifarme}
                var frameElement = defaultView.frameElement;
                var $ownerDocument = $(ownerDocument);
                var docLeft = $ownerDocument.scrollLeft();
                var docTop = $ownerDocument.scrollTop();
                var frameOffset = $(frameElement).offset();
                var frameLeft = frameOffset.left;
                var frameTop = frameOffset.top;

                return {
                    left: offset.left + frameLeft - docLeft,
                    top: offset.top + frameTop - docTop
                };
            },


            // ������������
            __lock: function () {

                var that = this;
                var popup = this.__popup;
                var backdrop = this.__backdrop;
                var backdropCss = {
                    position: 'fixed',
                    left: 0,
                    top: 0,
                    width: '100%',
                    height: '100%',
                    overflow: 'hidden',
                    userSelect: 'none',
                    opacity: 0,
                    background: this.backdropBackground
                };


                popup.addClass(this.className + '-modal');


                // �������ֲ��ܸ�ס��һ�εĶԻ���
                // �����ǰ�Ի�������һ���Ի��򴴽����������һ˲���������� zIndex ֵ
                Popup.zIndex = Popup.zIndex + 2;
                this.__zIndex();


                if (!_isFixed) {
                    $.extend(backdropCss, {
                        position: 'absolute',
                        width: $(window).width() + 'px',
                        height: $(document).height() + 'px'
                    });
                }


                backdrop
                .css(backdropCss)
                .animate({ opacity: this.backdropOpacity }, 150)
                .insertAfter(popup)
                // ��סģ̬�Ի���� tab �򵥰취
                // �������Ա��⽹������Ի������ iframe ��
                .attr({ tabindex: '0' })
                .on('focus', function () {
                    that.focus();
                });

            },


            // ж����������
            __unlock: function () {

                if (this.modal) {
                    this.__popup.removeClass(this.className + '-modal');
                    this.__backdrop.remove();
                    delete this.modal;
                }
            }

        });


        /** ��ǰ���Ӹ߶� */
        Popup.zIndex = 1024;


        /** ���㸡���ʵ�� */
        Popup.current = null;


        return Popup;

    });




    /*!
        * artDialog
        * Date: 2014-06-29
        * https://github.com/aui/artDialog
        * (c) 2009-2013 TangBin, http://www.planeArt.cn
        *
        * This is licensed under the GNU LGPL, version 2.1 or later.
        * For details, see: http://www.gnu.org/licenses/lgpl-2.1.html
        */
    define("dialog", function (innerRequire) {

        var $ = innerRequire("jquery");
        var Popup = innerRequire("popup");
        var defaults = innerRequire("dialog-config");
        var css = defaults.cssUri;


        // css loader: RequireJS & SeaJS
        if (css) {
            var fn = innerRequire[innerRequire.toUrl ? 'toUrl' : 'resolve'];
            if (fn) {
                css = fn(css);
                css = '<link rel="stylesheet" href="' + css + '" />';
                if ($('base')[0]) {
                    $('base').before(css);
                } else {
                    $('head').append(css);
                }
            }
        }


        var _count = 0;
        var _expando = new Date() - 0; // Data.now()
        var _isIE6 = !('minWidth' in $('html')[0].style);
        var _isMobile = 'createTouch' in document && !('onmousemove' in document)
            || /(iPhone|iPad|iPod)/i.test(navigator.userAgent);
        var _isFixed = !_isIE6 && !_isMobile;


        var artDialog = function (options, ok, cancel) {

            var originalOptions = options = options || {};


            if (typeof options === 'string' || options.nodeType === 1) {

                options = { content: options, fixed: !_isMobile };
            }


            options = $.extend(true, {}, artDialog.defaults, options);
            options._ = originalOptions;

            var id = options.id = options.id || _expando + _count;
            var api = artDialog.get(id);


            // �������ͬ���ĶԻ��������ֱ�ӷ���
            if (api) {
                return api.focus();
            }


            // Ŀǰ�����ƶ��豸��fixed֧�ֲ��ã����ô�����
            if (!_isFixed) {
                options.fixed = false;
            }


            // ��ݹر�֧�֣�����Ի�������ٹرնԻ���
            if (options.quickClose) {
                options.modal = true;
                if (!originalOptions.backdropOpacity) {
                    options.backdropOpacity = 0;
                }
            }


            // ��ť��
            if (!$.isArray(options.button)) {
                options.button = [];
            }


            // ȡ����ť
            if (cancel !== undefined) {
                options.cancel = cancel;
            }

            if (options.cancel) {
                options.button.push({
                    id: 'cancel',
                    value: options.cancelValue,
                    callback: options.cancel,
                    display: options.cancelDisplay
                });
            }


            // ȷ����ť
            if (ok !== undefined) {
                options.ok = ok;
            }

            if (options.ok) {
                options.button.push({
                    id: 'ok',
                    value: options.okValue,
                    callback: options.ok,
                    autofocus: true
                });
            }


            return artDialog.list[id] = new artDialog.create(options);
        };

        var popup = function () { };
        popup.prototype = Popup.prototype;
        var prototype = artDialog.prototype = new popup();

        artDialog.create = function (options) {
            var that = this;

            $.extend(this, new Popup());

            var $popup = $(this.node).html(options.innerHTML);

            this.options = options;
            this._popup = $popup;


            $.each(options, function (name, value) {
                if (typeof that[name] === 'function') {
                    that[name](value);
                } else {
                    that[name] = value;
                }
            });


            // ���� zIndex ȫ������
            if (options.zIndex) {
                Popup.zIndex = options.zIndex;
            }


            // ���� ARIA ��Ϣ
            $popup.attr({
                'aria-labelledby': this._$('title')
                    .attr('id', 'title:' + this.id).attr('id'),
                'aria-describedby': this._$('content')
                    .attr('id', 'content:' + this.id).attr('id')
            });


            // �رհ�ť
            this._$('close')
            .css('display', this.cancel === false ? 'none' : '')
            .attr('title', this.cancelValue)
            .on('click', function (event) {
                that._trigger('cancel');
                event.preventDefault();
            });


            // ����Ӿ�����
            this._$('dialog').addClass(this.skin);
            this._$('body').css('padding', this.padding);


            // ��ť����
            $popup.on('click', '[data-id]', function (event) {
                var $this = $(this);
                if (!$this.attr('disabled')) {// IE BUG
                    that._trigger($this.data('id'));
                }

                event.preventDefault();
            });


            // ��������Զ��رնԻ���
            if (options.quickClose) {
                $(this.backdrop).on(
                    'onmousedown' in document ? 'mousedown' : 'click',
                    function () {
                        that._trigger('cancel');
                    });
            }


            // ESC ��ݼ��رնԻ���
            this._esc = function (event) {
                var target = event.target;
                var nodeName = target.nodeName;
                var rinput = /^input|textarea$/i;
                var isTop = Popup.current === that;
                var keyCode = event.keyCode;

                // ��������״̬�� ESC ������ر�
                if (!isTop || rinput.test(nodeName) && target.type !== 'button') {
                    return;
                }

                if (keyCode === 27) {
                    that._trigger('cancel');
                }
            };

            $(document).on('keydown', this._esc);
            this.addEventListener('remove', function () {
                $(document).off('keydown', this._esc);
                delete artDialog.list[this.id];
            });


            _count++;

            artDialog.oncreate(this);

            return this;
        };


        artDialog.create.prototype = prototype;



        $.extend(prototype, {

            /**
                * ��ʾ�Ի���
                * @name artDialog.prototype.show
                * @param   {HTMLElement Object, Event Object}  ָ��λ�ã���ѡ��
                */

            /**
                * ��ʾ�Ի���ģ̬��
                * @name artDialog.prototype.showModal
                * @param   {HTMLElement Object, Event Object}  ָ��λ�ã���ѡ��
                */

            /**
                * �رնԻ���
                * @name artDialog.prototype.close
                * @param   {String, Number}    ����ֵ���ɱ� onclose �¼���ȡ����ѡ��
                */

            /**
                * ���ٶԻ���
                * @name artDialog.prototype.remove
                */

            /**
                * ���öԻ���λ��
                * @name artDialog.prototype.reset
                */

            /**
                * �öԻ���۽���ͬʱ�ö���
                * @name artDialog.prototype.focus
                */

            /**
                * �öԻ���ʧ����ͬʱ�ö���
                * @name artDialog.prototype.blur
                */

            /**
                * ����¼�
                * @param   {String}    �¼�����
                * @param   {Function}  ��������
                * @name artDialog.prototype.addEventListener
                */

            /**
                * ɾ���¼�
                * @param   {String}    �¼�����
                * @param   {Function}  ��������
                * @name artDialog.prototype.removeEventListener
                */

            /**
                * �Ի�����ʾ�¼����� show()��showModal() ִ��
                * @name artDialog.prototype.onshow
                * @event
                */

            /**
                * �ر��¼����� close() ִ��
                * @name artDialog.prototype.onclose
                * @event
                */

            /**
                * ����ǰ�¼����� remove() ǰִ��
                * @name artDialog.prototype.onbeforeremove
                * @event
                */

            /**
                * �����¼����� remove() ִ��
                * @name artDialog.prototype.onremove
                * @event
                */

            /**
                * �����¼����� reset() ִ��
                * @name artDialog.prototype.onreset
                * @event
                */

            /**
                * �����¼����� foucs() ִ��
                * @name artDialog.prototype.onfocus
                * @event
                */

            /**
                * ʧ���¼����� blur() ִ��
                * @name artDialog.prototype.onblur
                * @event
                */


            /**
                * ��������
                * @param    {String, HTMLElement}   ����
                */
            content: function (html) {

                this._$('content').empty('')
                [typeof html === 'object' ? 'append' : 'html'](html);

                return this.reset();
            },


            /**
                * ���ñ���
                * @param    {String}   ��������
                */
            title: function (text) {
                this._$('title').text(text);
                this._$('header')[text ? 'show' : 'hide']();
                return this;
            },


            /** ���ÿ�� */
            width: function (value) {
                this._$('content').css('width', value);
                return this.reset();
            },


            /** ���ø߶� */
            height: function (value) {
                this._$('content').css('height', value);
                return this.reset();
            },


            /**
                * ���ð�ť��
                * @param   {Array, String}
                */
            button: function (args) {
                args = args || [];
                var that = this;
                var html = '';
                var number = 0;
                this.callbacks = {};



                if (typeof args === 'string') {
                    html = args;
                } else {
                    $.each(args, function (i, val) {

                        val.id = val.id || val.value;
                        that.callbacks[val.id] = val.callback;

                        var style = '';

                        if (val.display === false) {
                            style = ' style="display:none"';
                        } else {
                            number++;
                        }

                        html +=
                            '<button'
                        + ' type="button"'
                        + ' data-id="' + val.id + '"'
                        + style
                        + (val.disabled ? ' disabled' : '')
                        + (val.autofocus ? ' autofocus class="ui-dialog-autofocus"' : '')
                        + '>'
                        + val.value
                        + '</button>';

                    });
                }

                this._$('footer')[number ? 'show' : 'hide']();
                this._$('button').html(html);

                return this;
            },


            statusbar: function (html) {
                this._$('statusbar')
                .html(html)[html ? 'show' : 'hide']();

                return this;
            },


            _$: function (i) {
                return this._popup.find('[i=' + i + ']');
            },


            // ������ť�ص�����
            _trigger: function (id) {

                var fn = this.callbacks[id];

                return typeof fn !== 'function' || fn.call(this) !== false ?
                    this.close().remove() : this;
            }

        });



        artDialog.oncreate = $.noop;



        /** ���ĶԻ���API */
        artDialog.getCurrent = function () {
            return Popup.current;
        };



        /**
            * ���� ID ��ȡĳ�Ի��� API
            * @param    {String}    �Ի��� ID
            * @return   {Object}    �Ի��� API (ʵ��)
            */
        artDialog.get = function (id) {
            return id === undefined
            ? artDialog.list
            : artDialog.list[id];
        };

        artDialog.list = {};



        /**
            * Ĭ������
            */
        artDialog.defaults = defaults;



        return artDialog;

    });




    /*!
        * drag.js
        * Date: 2013-12-06
        * (c) 2009-2013 TangBin, http://www.planeArt.cn
        *
        * This is licensed under the GNU LGPL, version 2.1 or later.
        * For details, see: http://www.gnu.org/licenses/lgpl-2.1.html
        */
    define("drag", function (innerRequire) {

        var $ = innerRequire("jquery");


        var $window = $(window);
        var $document = $(document);
        var isTouch = 'createTouch' in document;
        var html = document.documentElement;
        var isIE6 = !('minWidth' in html.style);
        var isLosecapture = !isIE6 && 'onlosecapture' in html;
        var isSetCapture = 'setCapture' in html;


        var types = {
            start: isTouch ? 'touchstart' : 'mousedown',
            over: isTouch ? 'touchmove' : 'mousemove',
            end: isTouch ? 'touchend' : 'mouseup'
        };


        var getEvent = isTouch ? function (event) {
            if (!event.touches) {
                event = event.originalEvent.touches.item(0);
            }
            return event;
        } : function (event) {
            return event;
        };


        var DragEvent = function () {
            this.start = $.proxy(this.start, this);
            this.over = $.proxy(this.over, this);
            this.end = $.proxy(this.end, this);
            this.onstart = this.onover = this.onend = $.noop;
        };

        DragEvent.types = types;

        DragEvent.prototype = {

            start: function (event) {
                event = this.startFix(event);

                $document
                .on(types.over, this.over)
                .on(types.end, this.end);

                this.onstart(event);
                return false;
            },

            over: function (event) {
                event = this.overFix(event);
                this.onover(event);
                return false;
            },

            end: function (event) {
                event = this.endFix(event);

                $document
                .off(types.over, this.over)
                .off(types.end, this.end);

                this.onend(event);
                return false;
            },

            startFix: function (event) {
                event = getEvent(event);

                this.target = $(event.target);
                this.selectstart = function () {
                    return false;
                };

                $document
                .on('selectstart', this.selectstart)
                .on('dblclick', this.end);

                if (isLosecapture) {
                    this.target.on('losecapture', this.end);
                } else {
                    $window.on('blur', this.end);
                }

                if (isSetCapture) {
                    this.target[0].setCapture();
                }

                return event;
            },

            overFix: function (event) {
                event = getEvent(event);
                return event;
            },

            endFix: function (event) {
                event = getEvent(event);

                $document
                .off('selectstart', this.selectstart)
                .off('dblclick', this.end);

                if (isLosecapture) {
                    this.target.off('losecapture', this.end);
                } else {
                    $window.off('blur', this.end);
                }

                if (isSetCapture) {
                    this.target[0].releaseCapture();
                }

                return event;
            }

        };


        /**
            * ������ק
            * @param   {HTMLElement}   ����ק��Ԫ��
            * @param   {Event} ������ק���¼����󡣿�ѡ����������� elem �İ����¼�����
            */
        DragEvent.create = function (elem, event) {
            var $elem = $(elem);
            var dragEvent = new DragEvent();
            var startType = DragEvent.types.start;
            var noop = function () { };
            var className = elem.className
                .replace(/^\s|\s.*/g, '') + '-drag-start';

            var minX;
            var minY;
            var maxX;
            var maxY;

            var api = {
                onstart: noop,
                onover: noop,
                onend: noop,
                off: function () {
                    $elem.off(startType, dragEvent.start);
                }
            };


            dragEvent.onstart = function (event) {
                var isFixed = $elem.css('position') === 'fixed';
                var dl = $document.scrollLeft();
                var dt = $document.scrollTop();
                var w = $elem.width();
                var h = $elem.height();

                minX = 0;
                minY = 0;
                maxX = isFixed ? $window.width() - w + minX : $document.width() - w;
                maxY = isFixed ? $window.height() - h + minY : $document.height() - h;

                var offset = $elem.offset();
                var left = this.startLeft = isFixed ? offset.left - dl : offset.left;
                var top = this.startTop = isFixed ? offset.top - dt : offset.top;

                this.clientX = event.clientX;
                this.clientY = event.clientY;

                $elem.addClass(className);
                api.onstart.call(elem, event, left, top);
            };


            dragEvent.onover = function (event) {
                var left = event.clientX - this.clientX + this.startLeft;
                var top = event.clientY - this.clientY + this.startTop;
                var style = $elem[0].style;

                left = Math.max(minX, Math.min(maxX, left));
                top = Math.max(minY, Math.min(maxY, top));

                style.left = left + 'px';
                style.top = top + 'px';

                api.onover.call(elem, event, left, top);
            };


            dragEvent.onend = function (event) {
                var position = $elem.position();
                var left = position.left;
                var top = position.top;
                $elem.removeClass(className);
                api.onend.call(elem, event, left, top);
            };


            dragEvent.off = function () {
                $elem.off(startType, dragEvent.start);
            };


            if (event) {
                dragEvent.start(event);
            } else {
                $elem.on(startType, dragEvent.start);
            }

            return api;
        };

        return DragEvent;

    });

    /*!
        * artDialog-plus
        * Date: 2013-12-25
        * https://github.com/aui/artDialog
        * (c) 2009-2013 TangBin, http://www.planeArt.cn
        *
        * This is licensed under the GNU LGPL, version 2.1 or later.
        * For details, see: http://www.gnu.org/licenses/lgpl-2.1.html
        */
    define("dialog-plus", function (innerRequire) {

        var $ = innerRequire("jquery");
        var dialog = innerRequire("dialog");
        var drag = innerRequire("drag");

        dialog.oncreate = function (api) {

            var options = api.options;
            var originalOptions = options._;

            // ҳ���ַ
            var url = options.url;
            // ҳ�������ϵ��¼�
            var oniframeload = options.oniframeload;

            var $iframe;


            if (url) {
                this.padding = options.padding = 0;

                $iframe = $('<iframe />');

                $iframe.attr({
                    src: url,
                    name: api.id,
                    width: '100%',
                    height: '100%',
                    allowtransparency: 'yes',
                    frameborder: 'no',
                    scrolling: 'no'
                })
                .on('load', function () {
                    var test;

                    try {
                        // �������
                        test = $iframe[0].contentWindow.frameElement;
                    } catch (e) { }

                    if (test) {

                        if (!options.width) {
                            api.width($iframe.contents().width());
                        }

                        if (!options.height) {
                            api.height($iframe.contents().height());
                        }
                    }

                    if (oniframeload) {
                        oniframeload.call(api);
                    }

                });

                api.addEventListener('beforeremove', function () {

                    // ��Ҫ����Ҫ����iframe��ַ�������´γ��ֵĶԻ�����IE6��7�޷��۽�input
                    // IEɾ��iframe��iframe��Ȼ�������ڴ��г����������⣬�û�src�������׽���ķ���
                    $iframe.attr('src', 'about:blank').remove();


                }, false);

                api.content($iframe[0]);

                api.iframeNode = $iframe[0];

            }


            // ������ҳ������ĶԻ������⴦��
            // ����Ի����������� iframe
            if (!(originalOptions instanceof Object)) {

                var un = function () {
                    api.close().remove();
                };

                // �ҵ��Ǹ� iframe
                for (var i = 0; i < frames.length; i++) {
                    try {
                        if (originalOptions instanceof frames[i].Object) {
                            // �� iframe ˢ��ǰʱ��Ҳ�رնԻ���
                            // ��ֹҪִ�еĶ���ǿ���ջص��� IE ����������ִ�����ͷ� Script �Ĵ��롱
                            $(frames[i]).one('unload', un);
                            break;
                        }
                    } catch (e) { }
                }
            }


            // ��ק֧��
            $(api.node).on(drag.types.start, '[i=title]', function (event) {
                // �ų��������͵ĶԻ���
                if (!api.follow) {
                    api.focus();
                    drag.create(api.node, event);
                }
            });

        };



        dialog.get = function (id) {

            // �� iframe ���� window ����
            if (id && id.frameElement) {
                var iframe = id.frameElement;
                var list = dialog.list;
                var api;
                for (var i in list) {
                    api = list[i];
                    if (api.node.getElementsByTagName('iframe')[0] === iframe) {
                        return api;
                    }
                }
                // ֱ�Ӵ��� id �����
            } else if (id) {
                return dialog.list[id];
            }

        };



        return dialog;

    });


    return innerRequire("dialog-plus");

});



